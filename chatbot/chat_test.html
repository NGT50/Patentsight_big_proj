<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŠ¹í—ˆ ì±—ë´‡ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .chat-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            background: #fafafa;
        }
        .message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
        }
        .user-message {
            background: #007bff;
            color: white;
            margin-left: 20%;
        }
        .bot-message {
            background: #e9ecef;
            color: #333;
            margin-right: 20%;
            white-space: pre-wrap;
        }
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        input, textarea {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        input[type="text"] {
            flex: 1;
        }
        textarea {
            width: 100%;
            height: 80px;
            resize: vertical;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #0056b3;
        }
        .preset-buttons {
            margin-bottom: 15px;
        }
        .preset-btn {
            margin: 5px;
            padding: 8px 15px;
            background: #28a745;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <h1>ğŸ¤– íŠ¹í—ˆ ì±—ë´‡ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="preset-buttons">
            <button class="preset-btn" onclick="loadPreset('validate')">ğŸ“ ë¬¸ì„œ ì ê²€ í…ŒìŠ¤íŠ¸</button>
            <button class="preset-btn" onclick="loadPreset('similar')">ğŸ” ìœ ì‚¬ íŠ¹í—ˆ ê²€ìƒ‰</button>
            <button class="preset-btn" onclick="loadPreset('claim')">âœï¸ ì²­êµ¬í•­ ì´ˆì•ˆ ìƒì„±</button>
            <button class="preset-btn" onclick="loadPreset('rejection')">âŒ ê±°ì ˆì‚¬ìœ  ë¶„ì„</button>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
                ì•ˆë…•í•˜ì„¸ìš”! íŠ¹í—ˆ ë¬¸ì„œ ì ê²€, ìœ ì‚¬íŠ¹í—ˆ ê²€ìƒ‰, ì²­êµ¬í•­ ì´ˆì•ˆ, ê±°ì ˆ ì‚¬ìœ  ì´ˆì•ˆ ì¤‘ ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?
            </div>
        </div>

        <div class="input-group">
            <input type="text" id="userMessage" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">ì „ì†¡</button>
        </div>

        <div>
            <label>ëª…ì„¸ì„œ ë‚´ìš© (application_text):</label>
            <textarea id="applicationText" placeholder="ëª…ì„¸ì„œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
        </div>

        <div>
            <label>ì²­êµ¬í•­ ë‚´ìš© (claims_text):</label>
            <textarea id="claimsText" placeholder="ì²­êµ¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
        </div>
    </div>

    <script>
        const sessionId = "user_" + Date.now();
        const chatMessages = document.getElementById('chatMessages');

        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            messageDiv.textContent = content;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function sendMessage() {
            const userMessage = document.getElementById('userMessage').value.trim();
            const applicationText = document.getElementById('applicationText').value.trim();
            const claimsText = document.getElementById('claimsText').value.trim();

            if (!userMessage) return;

            // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
            addMessage(userMessage, true);
            document.getElementById('userMessage').value = '';

            try {
                const response = await fetch('http://localhost:58080/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        session_id: sessionId,
                        user_msg: userMessage,
                        application_text: applicationText,
                        claims_text: claimsText
                    })
                });

                if (response.ok) {
                    const result = await response.text();
                    addMessage(result, false);
                } else {
                    addMessage(`âŒ ì˜¤ë¥˜: ${response.status} ${response.statusText}`, false);
                }
            } catch (error) {
                addMessage(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, false);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function loadPreset(type) {
            const presets = {
                validate: {
                    message: "ë‚´ ì„œë¥˜ì— ë¬¸ì œ ìˆëŠ”ì§€ í™•ì¸í•´ì¤˜",
                    application: "ë³¸ ë°œëª…ì€ ì¸ê³µì§€ëˆ™ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œì— ê´€í•œ ê²ƒì´ë‹¤. ì´ ì‹œìŠ¤í…œì€ ê¸°ì¡´ì˜ ìˆ˜ë™ ê²€ìƒ‰ ë°©ì‹ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , ëŒ€ìš©ëŸ‰ íŠ¹í—ˆ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê´€ë ¨ íŠ¹í—ˆë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ì•„ë‚´ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤. ë°°ê²½ê¸°ìˆ  ì„¹ì…˜ì´ ëˆ„ë½ë˜ì–´ ìˆê³ , ê¸°ìˆ ì  íš¨ê³¼ê°€ ëª…í™•í•˜ì§€ ì•Šìœ¼ë©°, ì²­êµ¬í•­ì˜ êµ¬ì„±ìš”ì†Œê°€ ë¶ˆì™„ì „í•˜ë‹¤.",
                    claims: "1. ì¸ê³µì§€ëˆ™ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œìœ¼ë¡œì„œ, ê²€ìƒ‰ ì—”ì§„ê³¼ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í¬í•¨í•˜ëŠ” ì‹œìŠ¤í…œ. 2. ì „í•­ì˜ ì‹œìŠˆí…œì— ìˆì–´ì„œ, ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ íŠ¹ì§•ìœ¼ë¡œ í•˜ëŠ” ì‹œìŠ¤í…œ."
                },
                similar: {
                    message: "ì¸ê³µì§€ëŠ¥ íŠ¹í—ˆ ê²€ìƒ‰ê³¼ ê´€ë ¨ëœ ìœ ì‚¬ íŠ¹í—ˆë¥¼ ì°¾ì•„ì¤˜",
                    application: "ë³¸ ë°œëª…ì€ ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œì— ê´€í•œ ê²ƒì´ë‹¤. ì´ ì‹œìŠ¤í…œì€ ë”¥ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹í—ˆ ë¬¸ì„œì˜ ì˜ë¯¸ë¥¼ ë¶„ì„í•˜ê³ , ì‚¬ìš©ìì˜ ê²€ìƒ‰ ì˜ë„ë¥¼ ì´í•´í•˜ì—¬ ê´€ë ¨ì„± ë†’ì€ íŠ¹í—ˆë¥¼ ì¶”ì²œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.",
                    claims: "1. ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œìœ¼ë¡œì„œ, ë”¥ëŸ¬ë‹ ëª¨ë¸ê³¼ ê²€ìƒ‰ ì—”ì§„ì„ í¬í•¨í•˜ëŠ” ì‹œìŠ¤í…œ."
                },
                claim: {
                    message: "ì¸ê³µì§€ëŠ¥ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œì— ëŒ€í•œ ì²­êµ¬í•­ì„ ì‘ì„±í•´ì¤˜",
                    application: "ë³¸ ë°œëª…ì€ ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œì— ê´€í•œ ê²ƒì´ë‹¤. ì´ ì‹œìŠ¤í…œì€ ìì—°ì–´ ì²˜ë¦¬ ê¸°ìˆ ì„ í™œìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ë¶„ì„í•˜ê³ , ë²¡í„° ìœ ì‚¬ë„ ê³„ì‚°ì„ í†µí•´ ê´€ë ¨ íŠ¹í—ˆë¥¼ ì°¾ì•„ë‚´ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.",
                    claims: ""
                },
                rejection: {
                    message: "ì´ íŠ¹í—ˆì— ëŒ€í•œ ê±°ì ˆì‚¬ìœ ë¥¼ ë¶„ì„í•´ì¤˜",
                    application: "ë³¸ ë°œëª…ì€ ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œì— ê´€í•œ ê²ƒì´ë‹¤.",
                    claims: "1. ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•œ íŠ¹í—ˆ ê²€ìƒ‰ ì‹œìŠ¤í…œ."
                }
            };

            const preset = presets[type];
            if (preset) {
                document.getElementById('userMessage').value = preset.message;
                document.getElementById('applicationText').value = preset.application;
                document.getElementById('claimsText').value = preset.claims;
            }
        }
    </script>
</body>
</html>
