<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <title>Inspector Chatbot</title>
  <style>
    body { font: 14px/1.4 system-ui, sans-serif; max-width: 800px; margin: 24px auto; }
    textarea, input { width: 100%; box-sizing: border-box; }
    .row { margin: 8px 0; }
    .log { white-space: pre-wrap; background: #f7f7f7; padding: 12px; border-radius: 8px; }
  </style>
</head>
<body>
  <h2>Inspector LangGraph Chatbot</h2>
  <div class="row">
    <label>메시지</label>
    <input id="msg" placeholder="예: 유사 특허 검색해줘"/>
  </div>
  <div class="row">
    <label>명세서 (선택)</label>
    <textarea id="app" rows="4"></textarea>
  </div>
  <div class="row">
    <label>청구항 (선택)</label>
    <textarea id="claims" rows="3"></textarea>
  </div>
  <div class="row">
    <label>patentId / fileId (선택, 거절 초안 API용)</label>
    <input id="pid" placeholder="예: 2"/>
    <input id="fid" placeholder="예: 1" style="margin-top:6px;"/>
  </div>
  <button id="send">전송</button>
  <div class="row">
    <h3>응답</h3>
    <div class="log" id="out"></div>
  </div>
<script>
const BASE = location.origin.replace(/:\d+$/, ":58080");
document.getElementById('send').onclick = async () => {
  const body = {
    session_id: "webdemo",
    user_msg: document.getElementById('msg').value || "",
    application_text: document.getElementById('app').value || "",
    claims_text: document.getElementById('claims').value || "",
    patent_id: parseInt(document.getElementById('pid').value || "0") || null,
    file_id: parseInt(document.getElementById('fid').value || "0") || null
  };
  const res = await fetch(`${BASE}/chat`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(body)
  });
  document.getElementById('out').textContent = await res.text();
};
</script>
</body>
</html>
